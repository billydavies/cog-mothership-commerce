{% extends 'Message:Mothership:Commerce::product:edit-layout' %}

{% block edit %}
	{{ form_start(form) }}
	<table>
		<thead>
			<tr>
				<th>{{ 'ms.commerce.product.units.sku.label'|trans }}</th>
				{% for heading in headings %}
					<th>{{heading}}</th>
				{% endfor %}
				<th>{{ 'ms.commerce.product.units.prices.label'|trans }}</th>
				<th>{{ 'ms.commerce.product.details.weight-grams.label'|trans }}</th>
				<th>{{ 'ms.commerce.product.units.visible.label'|trans }}</th>
				<th>{{ 'ms.commerce.product.units.delete.label'|trans }}</th>
			</tr>
		</thead>
		<tbody>
			{% for unit in units %}
				<tr>
					<td>{{ form_widget(form[unit.id]['sku']) }}</td>
					{% for name, title in headings %}
						<td>
							{{ form_widget(form[unit.id]['optionForm'][name]) }}
						</td>
					{% endfor %}
					<td>
					{% for name, value in unit.price %}
						<div class="inline">
							{{ form_row(form[unit.id]['price'][name]) }}
						</div>
					{% endfor %}
					</td>
					<td>{{ form_widget(form[unit.id]['weight']) }}</td>
					<td>{{ form_widget(form[unit.id]['visible']) }}</td>
					<td>{{ form_widget(form[unit.id]['delete']) }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<button type="submit" class="button small save" id="save-content">
		{{ 'ms.commerce.product.button.save'|trans }}
	</button>
	{{ form_end(form) }}

	{% macro getRepeatablePrototype(repeatable) %}
		{% filter escape %}
			<section class="group">
				{% for field in repeatable.vars.prototype %}
					{{ form_row(field) }}
				{% endfor %}
				<a href="#" data-group-remove class="button small remove">Remove Option</a>
			</section>
		{% endfilter %}
	{% endmacro %}

	{{ form_start(addForm) }}

	{{ form_row(addForm.sku) }}

	<section class="display-group">
		<h2 class="title">Options</h2>
		<div class="content-wrap">
			<section class="repeatable-group">
				{% do addForm.options.setRendered %}
				<div class="add-group">
					<a href="#" data-group-add data-prototype="{{ _self.getRepeatablePrototype(addForm.options) }}" class="button small add">
						Add option
					</a>
				</div>
			</section>
		</div>
	</section>

	{{ form_rest(addForm) }}
	<button type="submit" class="button small submit">
		{{ 'ms.commerce.product.button.save'|trans }}
	</button>

	{{ form_end(addForm) }}

{% endblock %}
